<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8" />
    <title>Control Escolar IDEE - Administrativo</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <link rel="stylesheet" href="../css/styles.css" />
</head>

<body>
    <div class="dashboard-wrapper">
        <!-- Navbar -->
        <nav class="navbar navbar-expand-lg navbar-dark fixed-top navbar-ide">
            <div class="container-fluid">
                <a class="navbar-brand fw-semibold" href="#">
                    IDEE • Administrativo
                </a>
                <span class="badge-role d-none d-md-inline-block ms-2">Control escolar</span>
                <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#adminNavbar">
                    <span class="navbar-toggler-icon"></span>
                </button>
                <div class="collapse navbar-collapse" id="adminNavbar">
                    <ul class="navbar-nav me-auto mb-2 mb-lg-0 ms-lg-4">
                        <li class="nav-item">
                            <a class="nav-link active" href="#" data-admin-section="programasSection">Programas</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#" data-admin-section="docentesSection">Docentes</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" href="#" data-admin-section="alumnosSection">Alumnos</a>
                        </li>
                        <li class="nav-item dropdown">
                            <a class="nav-link dropdown-toggle" href="#" id="controlEscolarDropdown" role="button"
                                data-bs-toggle="dropdown">
                                Control escolar
                            </a>
                            <ul class="dropdown-menu">
                                <li>
                                    <a class="dropdown-item" href="#"
                                        data-admin-section="calificacionesSection">Calificaciones</a>
                                </li>
                                <li>
                                    <a class="dropdown-item" href="#" data-admin-section="horariosSection">Horarios</a>
                                </li>
                                <li>
                                    <a class="dropdown-item" href="#"
                                        data-admin-section="certificadosSection">Certificados</a>
                                </li>
                                <li>
                                    <a class="dropdown-item" href="#"
                                        data-admin-section="constanciasSection">Constancias</a>
                                </li>
                                <li><hr class="dropdown-divider"></li>
                                <li>
                                    <a class="dropdown-item" href="#"
                                        data-admin-section="configuracionSepSection">Configuración Títulos SEP</a>
                                </li>
                                <li>
                                    <a class="dropdown-item" href="titulos-electronicos.html"
                                       >Títulos Electrónicos</a>
                                </li>
                            </ul>
                        </li>
                    </ul>
                    <span class="me-3 small text-light">personal@ide.edu.mx</span>
                    <a href="../index.html" class="btn btn-outline-light btn-sm">
                        Cerrar sesión
                    </a>
                </div>
            </div>
        </nav>

        <div class="container dashboard-content">

            <!-- PROGRAMAS + ASIGNATURAS -->
            <section id="programasSection" class="admin-section">
                <h3 class="section-title">Programas educativos</h3>
                <p class="text-muted">
                    Alta, modificación y baja de programas (licenciatura, maestría, especialidad, doctorado),
                    así como la captura de sus asignaturas.
                </p>

                <!-- Alta programa -->
                <div class="card mb-4">
                    <div class="card-header bg-soft-primary">
                        Nuevo programa educativo
                    </div>
                    <div class="card-body">
                        <form class="row g-3">
                            <div class="col-md-3">
                                <label class="form-label">Clave</label>
                                <input type="text" class="form-control" placeholder="ODO" />
                            </div>
                            <div class="col-md-5">
                                <label class="form-label">Nombre del programa</label>
                                <input type="text" class="form-control" placeholder="Licenciatura en Administración" />
                            </div>
                            <div class="col-md-2">
                                <label class="form-label">Tipo de programa</label>
                                <select class="form-select">
                                    <option value="">Selecciona...</option>
                                    <option>Licenciatura</option>
                                    <option>Maestría</option>
                                    <option>Especialidad</option>
                                    <option>Doctorado</option>
                                </select>
                            </div>
                            <div class="col-md-2">
                                <label class="form-label">Duración (periodos)</label>
                                <input type="number" min="1" class="form-control" placeholder="8" />
                            </div>

                            <div class="col-md-3">
                                <label class="form-label">Tipo de periodo</label>
                                <select class="form-select">
                                    <option>Semestre</option>
                                    <option>Trimestre</option>
                                    <option>Cuatrimestre</option>
                                </select>
                            </div>
                            <div class="col-md-3">
                                <label class="form-label">Modalidad</label>
                                <select class="form-select">
                                    <option>Escolarizado</option>
                                    <option>Mixto</option>
                                    <option>En línea</option>
                                </select>
                            </div>
                            <div class="col-md-3">
                                <label class="form-label">Créditos totales</label>
                                <input type="number" class="form-control" />
                            </div>
                            <div class="col-md-3">
                                <label class="form-label">RVOE</label>
                                <input type="text" class="form-control" placeholder="RVOE-2025-12345" />
                            </div>

                            <div class="col-md-3">
                                <label class="form-label">Fecha de RVOE</label>
                                <input type="date" class="form-control" />
                            </div>
                            <div class="col-md-3">
                                <label class="form-label">Estatus</label>
                                <select class="form-select">
                                    <option>Activo</option>
                                    <option>Inactivo</option>
                                </select>
                            </div>
                            <div class="col-md-6 d-flex align-items-end justify-content-end">
                                <button type="button" class="btn btn-ide">
                                    Guardar programa
                                </button>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- Lista programas -->
                <div class="card mb-4">
                    <div class="card-header d-flex justify-content-between align-items-center bg-soft-primary">
                        <span>Programas registrados</span>
                        <input type="text" class="form-control form-control-sm w-auto"
                            placeholder="Buscar por clave o nombre" />
                    </div>
                    <div class="card-body p-0">
                        <div class="table-responsive">
                            <table class="table table-hover mb-0 align-middle">
                                <thead class="table-light">
                                    <tr>
                                        <th>Clave</th>
                                        <th>Programa</th>
                                        <th>Tipo</th>
                                        <th>Periodo</th>
                                        <th>RVOE</th>
                                        <th>Estatus</th>
                                        <th>Acciones</th>
                                    </tr>
                                </thead>
                                <tbody id="programasTableBody">
                                    <tr>
                                        <td colspan="6" class="text-center text-muted py-4">
                                            <i class="bi bi-hourglass-split"></i> Cargando programas...
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- Asignaturas del programa seleccionado -->
                <div class="card">
                    <div class="card-header bg-soft-primary d-flex justify-content-between align-items-center">
                        <span>Asignaturas del programa: <strong id="programaSeleccionadoLabel">Seleccione un
                                programa...</strong></span>
                        <button class="btn btn-ide btn-sm" type="button">
                            Agregar asignatura
                        </button>
                    </div>
                    <div class="card-body">
                        <!-- Alta de asignaturas del programa -->
                        <form class="row g-3 mb-4">
                            <div class="col-md-2">
                                <label class="form-label">Clave</label>
                                <input type="text" class="form-control" placeholder="MAT" />
                            </div>
                            <div class="col-md-4">
                                <label class="form-label">Nombre de la asignatura</label>
                                <input type="text" class="form-control" placeholder="Cálculo Diferencial" />
                            </div>
                            <div class="col-md-2">
                                <label class="form-label">Tipo</label>
                                <select class="form-select">
                                    <option>Obligatoria</option>
                                    <option>Optativa</option>
                                    <option>Libre</option>
                                </select>
                            </div>
                            <div class="col-md-2">
                                <label class="form-label">Periodo (sem/tri/cuat)</label>
                                <input type="number" min="1" class="form-control" placeholder="1" />
                            </div>
                            <div class="col-md-2">
                                <label class="form-label">Créditos</label>
                                <input type="number" class="form-control" placeholder="8" />
                            </div>

                            <div class="col-md-3">
                                <label class="form-label">Horas con docente (aula)</label>
                                <input type="number" class="form-control" placeholder="3" />
                            </div>
                            <div class="col-md-3">
                                <label class="form-label">Horas con docente (práctica)</label>
                                <input type="number" class="form-control" placeholder="2" />
                            </div>
                            <div class="col-md-3">
                                <label class="form-label">Horas independientes</label>
                                <input type="number" class="form-control" placeholder="3" />
                            </div>
                            <div class="col-md-3">
                                <label class="form-label">Estatus</label>
                                <select class="form-select">
                                    <option>Activa</option>
                                    <option>Inactiva</option>
                                </select>
                            </div>

                            <div class="col-md-3 d-flex align-items-end">
                                <button type="button" class="btn btn-ide w-100">
                                    Guardar asignatura
                                </button>
                            </div>
                        </form>

                        <!-- Lista de asignaturas -->
                        <div class="table-responsive">
                            <table class="table table-hover align-middle mb-0">
                                <thead class="table-light">
                                    <tr>
                                        <th>Clave</th>
                                        <th>Asignatura</th>
                                        <th>Tipo</th>
                                        <th>Periodo</th>
                                        <th>Créditos</th>
                                        <th>Horas aula/práctica/indep.</th>
                                        <th>Maestro asignado</th>
                                        <th>Estatus</th>
                                        <th>Acciones</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>PROG-I</td>
                                        <td>Programación I</td>
                                        <td>Obligatoria</td>
                                        <td>1</td>
                                        <td>8</td>
                                        <td>3 / 2 / 3</td>
                                        <td>
                                            <select class="form-select form-select-sm">
                                                <option value="">Sin asignar</option>
                                                <option>Juan Pérez</option>
                                                <option>María López</option>
                                            </select>
                                        </td>
                                        <td><span class="badge bg-success-subtle text-success">Activa</span></td>
                                        <td>
                                            <button class="btn btn-sm btn-outline-secondary me-1"
                                                onclick="demoEdit('asignatura')">
                                                Editar
                                            </button>
                                            <button class="btn btn-sm btn-outline-danger"
                                                onclick="confirmDelete('asignatura','Programación I')">
                                                Eliminar
                                            </button>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>CALC-I</td>
                                        <td>Cálculo Diferencial</td>
                                        <td>Obligatoria</td>
                                        <td>1</td>
                                        <td>8</td>
                                        <td>3 / 2 / 2</td>
                                        <td>
                                            <select class="form-select form-select-sm">
                                                <option value="">Sin asignar</option>
                                                <option>Juan Pérez</option>
                                                <option>María López</option>
                                            </select>
                                        </td>
                                        <td><span class="badge bg-success-subtle text-success">Activa</span></td>
                                        <td>
                                            <button class="btn btn-sm btn-outline-secondary me-1"
                                                onclick="demoEdit('asignatura')">
                                                Editar
                                            </button>
                                            <button class="btn btn-sm btn-outline-danger"
                                                onclick="confirmDelete('asignatura','Cálculo Diferencial')">
                                                Eliminar
                                            </button>
                                        </td>
                                    </tr>
                                    <!-- Más filas -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </section>

            <!-- DOCENTES -->
            <section id="docentesSection" class="admin-section d-none">
                <h3 class="section-title">Docentes</h3>
                <p class="text-muted">
                    Administración de maestros y sus datos fiscales y académicos.
                </p>

                <div class="card mb-4">
                    <div class="card-header bg-soft-primary">
                        Alta de maestro
                    </div>
                    <div class="card-body">
                        <form class="row g-3">
                            <div class="col-md-3">
                                <label class="form-label">CURP (clave de maestro)</label>
                                <input type="text" class="form-control" placeholder="CURP..." />
                            </div>
                            <div class="col-md-3">
                                <label class="form-label">Nombre(s)</label>
                                <input type="text" class="form-control" />
                            </div>
                            <div class="col-md-3">
                                <label class="form-label">Apellido paterno</label>
                                <input type="text" class="form-control" />
                            </div>
                            <div class="col-md-3">
                                <label class="form-label">Apellido materno</label>
                                <input type="text" class="form-control" />
                            </div>

                            <div class="col-md-3">
                                <label class="form-label">Etiqueta (cómo desea ser llamado)</label>

                                <div class="row g-2">
                                    <div class="col-md-6">
                                        <select class="form-select" id="etiquetaSelect"
                                            onchange="mostrarCampoOtroEtiqueta()">
                                            <option value="">Selecciona...</option>
                                            <option>Dr.</option>
                                            <option>Dra.</option>
                                            <option>Mtro.</option>
                                            <option>Mtra.</option>
                                            <option>Lic.</option>
                                            <option>CDEO</option>
                                            <option>CDEE</option>
                                            <option>CDEP</option>
                                            <option>LOEO</option>
                                            <!-- Opción para permitir personalizar -->
                                            <option value="otro">Otro (especificar)</option>
                                        </select>
                                    </div>

                                    <!-- Campo que aparece solo si selecciona "otro" -->
                                    <div class="col-md-6 d-none" id="campoEtiquetaOtro">
                                        <input type="text" id="etiquetaOtro" class="form-control"
                                            placeholder="Especificar…" />
                                    </div>
                                </div>

                            </div>
                            <div class="col-md-3">
                                <label class="form-label">Último grado académico</label>
                                <select class="form-select">
                                    <option>Licenciatura</option>
                                    <option>Especialidad</option>
                                    <option>Maestría</option>
                                    <option>Doctorado</option>
                                </select>
                            </div>
                            <div class="col-md-3">
                                <label class="form-label">Cédula profesional</label>
                                <input type="text" class="form-control" placeholder="Número de cédula" />
                            </div>
                            <div class="col-md-3">
                                <label class="form-label">Área / Departamento</label>
                                <select class="form-select">
                                    <option>Salud</option>
                                    <option>Ciencias sociales</option>
                                    <option>Humanidades</option>
                                    <option>Ingenierías</option>
                                </select>
                            </div>

                            <div class="col-md-3">
                                <label class="form-label">Correo institucional</label>
                                <input type="email" class="form-control" placeholder="maestro@ide.edu.mx" />
                            </div>
                            <div class="col-md-3">
                                <label class="form-label">Correo personal</label>
                                <input type="email" class="form-control" placeholder="correo personal" />
                            </div>
                            <div class="col-md-3">
                                <label class="form-label">Teléfono</label>
                                <input type="tel" class="form-control" />
                            </div>
                            <div class="col-md-3">
                                <label class="form-label">Código postal</label>
                                <input type="text" class="form-control" placeholder="CP" />
                            </div>

                            <div class="col-md-3">
                                <label class="form-label">RFC</label>
                                <input type="text" class="form-control" placeholder="RFC" />
                            </div>
                            <div class="col-md-3">
                                <label class="form-label">Régimen fiscal</label>
                                <select class="form-select">
                                    <option>.........</option>
                                    <option>.........</option>
                                    <option>.........</option>
                                </select>
                            </div>
                            <div class="col-md-3">
                                <label class="form-label">Tipo de maestro</label>
                                <select class="form-select">
                                    <option>Tiempo completo</option>
                                    <option>Medio tiempo</option>
                                    <option>Por horas</option>
                                </select>
                            </div>
                            <div class="col-md-3">
                                <label class="form-label">Fecha de alta</label>
                                <input type="date" class="form-control" />
                            </div>

                            <div class="col-md-3">
                                <label class="form-label">Activo</label>
                                <select class="form-select">
                                    <option>Sí</option>
                                    <option>No</option>
                                </select>
                            </div>
                            <div class="col-md-9">
                                <label class="form-label">Antecedentes académicos (PDF)</label>
                                <input type="file" class="form-control" multiple accept="application/pdf" />
                                <div class="form-text">
                                    Puedes subir varios PDFs: CV, constancias, diplomas, etc.
                                </div>
                            </div>

                            <div class="col-md-12">
                                <label class="form-label">Observaciones</label>
                                <textarea class="form-control" rows="2"></textarea>
                            </div>
                            <div class="col-md-3 d-flex align-items-end">
                                <button type="button" class="btn btn-ide w-100">
                                    Guardar maestro
                                </button>
                            </div>
                        </form>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header d-flex justify-content-between align-items-center bg-soft-primary">
                        <span>Docentes registrados</span>
                        <input type="text" class="form-control form-control-sm w-auto"
                            placeholder="Buscar por nombre, CURP o correo" />
                    </div>
                    <div class="card-body p-0">
                        <div class="table-responsive">
                            <table class="table table-hover mb-0 align-middle">
                                <thead class="table-light">
                                    <tr>
                                        <th>CURP</th>
                                        <th>Nombre</th>
                                        <th>Etiqueta</th>
                                        <th>Grado</th>
                                        <th>Área</th>
                                        <th>Estatus</th>
                                        <th>Acciones</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>CURPXXXX1234</td>
                                        <td>Juan Pérez López</td>
                                        <td>Mtro.</td>
                                        <td>Maestría</td>
                                        <td>Ingenierías</td>
                                        <td><span class="badge bg-success-subtle text-success">Activo</span></td>
                                        <td>
                                            <button class="btn btn-sm btn-outline-secondary me-1"
                                                onclick="demoEdit('docente')">
                                                Editar
                                            </button>
                                            <button class="btn btn-sm btn-outline-danger"
                                                onclick="confirmDelete('docente','Juan Pérez López')">
                                                Eliminar
                                            </button>
                                        </td>
                                    </tr>
                                    <!-- Más filas -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

            </section>

            <!-- ALUMNOS -->
            <section id="alumnosSection" class="admin-section d-none">
                <h3 class="section-title">Alumnos</h3>
                <p class="text-muted">
                    Captura, consulta, edición y baja de alumnos inscritos en la institución.
                </p>

                <!-- Lista de alumnos -->
                <div class="card mb-4">
                    <div class="card-header bg-soft-primary d-flex justify-content-between align-items-center">
                        <span>
                            <i class="bi bi-people-fill"></i> Alumnos Registrados
                        </span>
                        <button class="btn btn-ide btn-sm" type="button" data-bs-toggle="modal" data-bs-target="#modalAlumno" onclick="nuevoAlumno()">
                            <i class="bi bi-plus-circle"></i> Nuevo Alumno
                        </button>
                    </div>

                    <div class="card-body">
                        <div class="mb-3">
                            <input type="text" class="form-control" id="buscarAlumnoInput"
                                   placeholder="Buscar por matrícula, nombre, CURP...">
                        </div>

                        <div class="table-responsive">
                            <table class="table table-hover mb-0 align-middle">
                                <thead class="table-light">
                                    <tr>
                                        <th>Matrícula</th>
                                        <th>Nombre Completo</th>
                                        <th>CURP</th>
                                        <th>Programa</th>
                                        <th>Estatus</th>
                                        <th>Acciones</th>
                                    </tr>
                                </thead>
                                <tbody id="alumnosTableBody">
                                    <tr>
                                        <td colspan="6" class="text-center">
                                            <div class="spinner-border text-primary" role="status">
                                                <span class="visually-hidden">Cargando...</span>
                                            </div>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

            </section>

            <!-- CALIFICACIONES -->
            <section id="calificacionesSection" class="admin-section d-none">
                <h3 class="section-title">Calificaciones (confirmación)</h3>
                <p class="text-muted">
                    El maestro captura las calificaciones con sus criterios. Aquí el personal administrativo
                    las revisa, corrige si es necesario y las confirma.
                </p>

                <div class="card mb-4">
                    <div class="card-header bg-soft-primary">
                        Filtros de calificaciones
                    </div>
                    <div class="card-body">
                        <form class="row g-3">
                            <div class="col-md-3">
                                <label class="form-label">Programa</label>
                                <select class="form-select">
                                    <option value="">Todos</option>
                                    <option>Lic. Ing. Sistemas</option>
                                    <option>Lic. Administración</option>
                                </select>
                            </div>
                            <div class="col-md-2">
                                <label class="form-label">Periodo / ciclo</label>
                                <select class="form-select">
                                    <option>2025-2</option>
                                    <option>2025-1</option>
                                </select>
                            </div>
                            <div class="col-md-2">
                                <label class="form-label">Grupo</label>
                                <input type="text" class="form-control" placeholder="3A" />
                            </div>
                            <div class="col-md-3">
                                <label class="form-label">Asignatura</label>
                                <input type="text" class="form-control" placeholder="Programación II" />
                            </div>
                            <div class="col-md-2">
                                <label class="form-label">Estatus</label>
                                <select class="form-select">
                                    <option>Todos</option>
                                    <option>Pendiente de revisión</option>
                                    <option>Confirmada</option>
                                </select>
                            </div>
                            <div class="col-md-4 d-flex align-items-end">
                                <button type="button" class="btn btn-ide me-2">
                                    Buscar
                                </button>
                                <button type="button" class="btn btn-outline-secondary">
                                    Limpiar filtros
                                </button>
                            </div>
                        </form>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header bg-soft-primary">
                        Calificaciones capturadas por maestros
                    </div>
                    <div class="card-body p-0">
                        <div class="table-responsive">
                            <table class="table table-hover align-middle mb-0">
                                <thead class="table-light">
                                    <tr>
                                        <th>Matrícula</th>
                                        <th>Alumno</th>
                                        <th>Programa</th>
                                        <th>Grupo</th>
                                        <th>Asignatura</th>
                                        <th>Calif. maestro</th>
                                        <th>Asistencia %</th>
                                        <th>Calif. final (editable)</th>
                                        <th>Estatus</th>
                                        <th>Confirmar</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>IDEE2025001</td>
                                        <td>María López García</td>
                                        <td>Ing. Sistemas</td>
                                        <td>3A</td>
                                        <td>Programación II</td>
                                        <td>90</td>
                                        <td>95%</td>
                                        <td><input type="number" min="0" max="100" class="form-control form-control-sm"
                                                value="90" /></td>
                                        <td><span class="badge bg-warning-subtle text-warning">Pendiente</span></td>
                                        <td>
                                            <button class="btn btn-sm btn-ide">
                                                Confirmar
                                            </button>
                                        </td>
                                    </tr>
                                    <!-- Más filas -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                    <div class="card-footer text-muted small">
                        Nota: Una vez confirmado aquí, el maestro ya no puede modificar la calificación.
                    </div>
                </div>
            </section>

            <!-- HORARIOS -->
            <section id="horariosSection" class="admin-section d-none">
                <h3 class="section-title">Horarios</h3>
                <p class="text-muted">
                    Construcción de horarios que los alumnos verán en su portal: asignaturas, horas, aulas y maestros.
                </p>

                <div class="card mb-4">
                    <div class="card-header bg-soft-primary">
                        Definir bloque de horario
                    </div>
                    <div class="card-body">
                        <form class="row g-3">
                            <div class="col-md-3">
                                <label class="form-label">Programa</label>
                                <select class="form-select">
                                    <option>Lic. Ing. Sistemas</option>
                                    <option>Lic. Administración</option>
                                </select>
                            </div>
                            <div class="col-md-2">
                                <label class="form-label">Periodo / ciclo</label>
                                <select class="form-select">
                                    <option>2025-2</option>
                                    <option>2025-1</option>
                                </select>
                            </div>
                            <div class="col-md-2">
                                <label class="form-label">Grupo</label>
                                <input type="text" class="form-control" placeholder="3A" />
                            </div>
                            <div class="col-md-2">
                                <label class="form-label">Día</label>
                                <select class="form-select">
                                    <option>Lunes</option>
                                    <option>Martes</option>
                                    <option>Miércoles</option>
                                    <option>Jueves</option>
                                    <option>Viernes</option>
                                    <option>Sábado</option>
                                </select>
                            </div>
                            <div class="col-md-1">
                                <label class="form-label">Hora inicio</label>
                                <input type="time" class="form-control" />
                            </div>
                            <div class="col-md-1">
                                <label class="form-label">Hora fin</label>
                                <input type="time" class="form-control" />
                            </div>
                            <div class="col-md-3">
                                <label class="form-label">Asignatura</label>
                                <select class="form-select">
                                    <option>Programación II</option>
                                    <option>Estructura de Datos</option>
                                </select>
                            </div>
                            <div class="col-md-3">
                                <label class="form-label">Maestro</label>
                                <select class="form-select">
                                    <option>Juan Pérez</option>
                                    <option>María López</option>
                                </select>
                            </div>
                            <div class="col-md-2">
                                <label class="form-label">Aula</label>
                                <input type="text" class="form-control" placeholder="Lab 1" />
                            </div>
                            <div class="col-md-2">
                                <label class="form-label">Estatus</label>
                                <select class="form-select">
                                    <option>Activo</option>
                                    <option>Cancelado</option>
                                </select>
                            </div>
                            <div class="col-md-2 d-flex align-items-end">
                                <button type="button" class="btn btn-ide w-100">
                                    Guardar bloque
                                </button>
                            </div>
                        </form>
                    </div>
                </div>

                <div class="card">
                    <div class="card-header bg-soft-primary">
                        Horario de ejemplo (lo que verá el alumno)
                    </div>
                    <div class="card-body p-0">
                        <div class="table-responsive">
                            <table class="table table-striped mb-0 align-middle">
                                <thead class="table-light">
                                    <tr>
                                        <th>Día</th>
                                        <th>Hora</th>
                                        <th>Programa</th>
                                        <th>Grupo</th>
                                        <th>Asignatura</th>
                                        <th>Maestro</th>
                                        <th>Aula</th>
                                        <th>Estatus</th>
                                        <th>Acciones</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>Lunes</td>
                                        <td>08:00 - 10:00</td>
                                        <td>Lic. Ing. Sistemas</td>
                                        <td>3A</td>
                                        <td>Programación II</td>
                                        <td>Juan Pérez</td>
                                        <td>Lab 1</td>
                                        <td><span class="badge bg-success-subtle text-success">Activo</span></td>
                                        <td>
                                            <button class="btn btn-sm btn-outline-secondary me-1"
                                                onclick="demoEdit('bloque de horario')">
                                                Editar
                                            </button>
                                            <button class="btn btn-sm btn-outline-danger"
                                                onclick="confirmDelete('bloque de horario','Lun 08:00 - Programación II')">
                                                Eliminar
                                            </button>
                                        </td>
                                    </tr>
                                    <!-- Más filas -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </section>

            <!-- CERTIFICADOS -->
            <section id="certificadosSection" class="admin-section d-none">
                <h3 class="section-title">Certificados</h3>
                <p class="text-muted">
                    Generación y control de certificados parciales y finales a partir de kardex y calificaciones
                    confirmadas.
                </p>
                <div class="alert alert-info">
                    Se integrará la generación de certificados con base en el historial de
                    calificaciones y créditos del alumno, listo para impresión o exportación.
                </div>
            </section>

            <!-- CONFIGURACIÓN TÍTULOS SEP -->
            <section id="configuracionSepSection" class="admin-section d-none">
                <h3 class="section-title">
                    <i class="bi bi-gear-fill text-primary"></i> Configuración de Títulos Electrónicos SEP
                </h3>
                <p class="text-muted">
                    Configuración institucional, responsables de firma y certificados digitales para la generación de títulos profesionales electrónicos.
                </p>

                <!-- Tabs de configuración -->
                <ul class="nav nav-tabs mb-4" id="configSepTabs" role="tablist">
                    <li class="nav-item" role="presentation">
                        <button class="nav-link active" id="institucion-sep-tab" data-bs-toggle="tab"
                                data-bs-target="#institucionSep" type="button" role="tab">
                            <i class="bi bi-building"></i> Institución
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="responsables-sep-tab" data-bs-toggle="tab"
                                data-bs-target="#responsablesSep" type="button" role="tab">
                            <i class="bi bi-people-fill"></i> Responsables de Firma
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="certificados-sep-tab" data-bs-toggle="tab"
                                data-bs-target="#certificadosSep" type="button" role="tab">
                            <i class="bi bi-shield-check"></i> Certificados SAT
                        </button>
                    </li>
                </ul>

                <div class="tab-content" id="configSepTabsContent">
                    <!-- TAB: Configuración Institucional -->
                    <div class="tab-pane fade show active" id="institucionSep" role="tabpanel">
                        <div class="card">
                            <div class="card-header bg-soft-primary">
                                <h5 class="mb-0">
                                    <i class="bi bi-building"></i> Configuración Institucional
                                </h5>
                            </div>
                            <div class="card-body">
                                <form id="formInstitucion">
                                    <input type="hidden" id="institucionId">

                                    <div class="row">
                                        <div class="col-md-6 mb-3">
                                            <label for="cveInstitucion" class="form-label">
                                                Clave de Institución <span class="text-danger">*</span>
                                            </label>
                                            <input type="text" class="form-control" id="cveInstitucion" required
                                                   placeholder="Ej: IDEE001" maxlength="50">
                                            <small class="text-muted">Clave asignada por la SEP</small>
                                        </div>

                                        <div class="col-md-6 mb-3">
                                            <label for="nombreInstitucion" class="form-label">
                                                Nombre de la Institución <span class="text-danger">*</span>
                                            </label>
                                            <input type="text" class="form-control" id="nombreInstitucion" required
                                                   placeholder="Nombre completo de la institución">
                                        </div>
                                    </div>

                                    <div class="row">
                                        <div class="col-md-6 mb-3">
                                            <label for="idEntidadFederativa" class="form-label">
                                                ID Entidad Federativa <span class="text-danger">*</span>
                                            </label>
                                            <input type="text" class="form-control" id="idEntidadFederativa" required
                                                   placeholder="Ej: 09" maxlength="10">
                                            <small class="text-muted">Código según catálogo SEP</small>
                                        </div>

                                        <div class="col-md-6 mb-3">
                                            <label for="entidadFederativa" class="form-label">
                                                Entidad Federativa <span class="text-danger">*</span>
                                            </label>
                                            <input type="text" class="form-control" id="entidadFederativa" required
                                                   placeholder="Ej: Ciudad de México">
                                        </div>
                                    </div>

                                    <div class="row">
                                        <div class="col-md-6 mb-3">
                                            <label for="noCertificadoSat" class="form-label">
                                                Número de Certificado SAT
                                            </label>
                                            <input type="text" class="form-control" id="noCertificadoSat"
                                                   placeholder="Número de serie del certificado">
                                        </div>
                                    </div>

                                    <div class="d-flex justify-content-end gap-2">
                                        <button type="button" class="btn btn-secondary" id="btnCancelarInstitucion">
                                            <i class="bi bi-x-circle"></i> Cancelar
                                        </button>
                                        <button type="submit" class="btn btn-ide">
                                            <i class="bi bi-save"></i> Guardar Configuración
                                        </button>
                                    </div>
                                </form>

                                <div id="alertaInstitucion" class="alert d-none mt-3" role="alert"></div>
                            </div>
                        </div>
                    </div>

                    <!-- TAB: Responsables de Firma -->
                    <div class="tab-pane fade" id="responsablesSep" role="tabpanel">
                        <div class="card">
                            <div class="card-header bg-soft-primary d-flex justify-content-between align-items-center">
                                <h5 class="mb-0">
                                    <i class="bi bi-people-fill"></i> Responsables Autorizados para Firmar
                                </h5>
                                <button class="btn btn-ide btn-sm" data-bs-toggle="modal" data-bs-target="#modalResponsable">
                                    <i class="bi bi-plus-circle"></i> Nuevo Responsable
                                </button>
                            </div>
                            <div class="card-body">
                                <div class="table-responsive">
                                    <table class="table table-hover">
                                        <thead class="table-light">
                                            <tr>
                                                <th>Orden</th>
                                                <th>Nombre Completo</th>
                                                <th>CURP</th>
                                                <th>Cargo</th>
                                                <th>Título</th>
                                                <th>Estado</th>
                                                <th>Acciones</th>
                                            </tr>
                                        </thead>
                                        <tbody id="tablaResponsables">
                                            <tr>
                                                <td colspan="7" class="text-center">
                                                    <div class="spinner-border text-primary" role="status">
                                                        <span class="visually-hidden">Cargando...</span>
                                                    </div>
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- TAB: Certificados SAT -->
                    <div class="tab-pane fade" id="certificadosSep" role="tabpanel">
                        <div class="card">
                            <div class="card-header bg-soft-primary">
                                <h5 class="mb-0">
                                    <i class="bi bi-shield-check"></i> Certificados Digitales SAT
                                </h5>
                            </div>
                            <div class="card-body">
                                <div class="alert alert-info">
                                    <i class="bi bi-info-circle"></i>
                                    <strong>Información:</strong> Los certificados digitales del SAT (.cer y .key) son necesarios
                                    para firmar electrónicamente los títulos profesionales según el estándar SEP.
                                </div>

                                <form id="formCertificados" enctype="multipart/form-data">
                                    <div class="mb-4">
                                        <label for="certificadoFile" class="form-label">
                                            Certificado SAT (.cer) <span class="text-danger">*</span>
                                        </label>
                                        <input type="file" class="form-control" id="certificadoFile"
                                               accept=".cer" required>
                                        <small class="text-muted">Seleccione el archivo .cer del SAT</small>
                                        <div id="certificadoStatus" class="mt-2"></div>
                                    </div>

                                    <div class="mb-4">
                                        <label for="llavePrivadaFile" class="form-label">
                                            Llave Privada (.key) <span class="text-danger">*</span>
                                        </label>
                                        <input type="file" class="form-control" id="llavePrivadaFile"
                                               accept=".key" required>
                                        <small class="text-muted">Seleccione el archivo .key del SAT</small>
                                        <div id="llaveStatus" class="mt-2"></div>
                                    </div>

                                    <div class="mb-4">
                                        <label for="passwordLlave" class="form-label">
                                            Contraseña de la Llave Privada <span class="text-danger">*</span>
                                        </label>
                                        <input type="password" class="form-control" id="passwordLlave"
                                               placeholder="Contraseña de la llave privada" required>
                                        <small class="text-muted">Se guardará de forma encriptada en la base de datos</small>
                                    </div>

                                    <div class="d-flex justify-content-end">
                                        <button type="submit" class="btn btn-ide">
                                            <i class="bi bi-upload"></i> Subir y Guardar Certificados
                                        </button>
                                    </div>
                                </form>

                                <div id="alertaCertificados" class="alert d-none mt-3" role="alert"></div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- TÍTULOS ELECTRÓNICOS -->
            <section id="titulosElectronicosSection" class="admin-section d-none">
                <h3 class="section-title">
                    <i class="bi bi-award-fill text-primary"></i> Generación de Títulos Profesionales Electrónicos
                </h3>
                <p class="text-muted">
                    Generación y consulta de títulos profesionales electrónicos según el estándar SEP.
                </p>

                <!-- Tabs de títulos -->
                <ul class="nav nav-tabs mb-4" id="titulosTabs" role="tablist">
                    <li class="nav-item" role="presentation">
                        <button class="nav-link active" id="generar-titulo-tab" data-bs-toggle="tab"
                                data-bs-target="#generarTitulo" type="button" role="tab">
                            <i class="bi bi-file-earmark-plus"></i> Generar Título
                        </button>
                    </li>
                    <li class="nav-item" role="presentation">
                        <button class="nav-link" id="consultar-titulos-tab" data-bs-toggle="tab"
                                data-bs-target="#consultarTitulos" type="button" role="tab">
                            <i class="bi bi-search"></i> Consultar Títulos
                        </button>
                    </li>
                </ul>

                <div class="tab-content" id="titulosTabsContent">
                    <!-- TAB: Generar Título -->
                    <div class="tab-pane fade show active" id="generarTitulo" role="tabpanel">
                        <div class="card">
                            <div class="card-header bg-soft-primary">
                                <h5 class="mb-0">
                                    <i class="bi bi-person-badge"></i> Datos del Alumno y Título
                                </h5>
                            </div>
                            <div class="card-body">
                                <div class="alert alert-info">
                                    <i class="bi bi-info-circle"></i>
                                    <strong>Nota:</strong> Complete todos los campos requeridos según el estándar SEP.
                                    Consulte el manual de catálogos para los IDs correctos.
                                </div>

                                <form id="formGenerarTitulo">
                                    <!-- Datos del Alumno -->
                                    <h6 class="border-bottom pb-2 mb-3">Datos del Profesionista</h6>
                                    <div class="row">
                                        <div class="col-md-6 mb-3">
                                            <label for="alumnoBuscar" class="form-label">
                                                Buscar Alumno <span class="text-danger">*</span>
                                            </label>
                                            <div class="input-group">
                                                <input type="text" class="form-control" id="alumnoBuscar"
                                                       placeholder="Matrícula o CURP">
                                                <button class="btn btn-primary" type="button" id="btnBuscarAlumno">
                                                    <i class="bi bi-search"></i> Buscar
                                                </button>
                                            </div>
                                        </div>
                                        <div class="col-md-6 mb-3">
                                            <label class="form-label">Alumno ID</label>
                                            <input type="number" class="form-control" id="alumnoIdTitulo" readonly>
                                        </div>
                                    </div>

                                    <!-- Datos del Programa -->
                                    <h6 class="border-bottom pb-2 mb-3 mt-4">Datos de la Carrera</h6>
                                    <div class="row">
                                        <div class="col-md-6 mb-3">
                                            <label for="programaEducativoId" class="form-label">
                                                Programa Educativo ID <span class="text-danger">*</span>
                                            </label>
                                            <input type="number" class="form-control" id="programaEducativoId" required>
                                        </div>
                                        <div class="col-md-6 mb-3">
                                            <label for="fechaInicio" class="form-label">
                                                Fecha de Inicio <span class="text-danger">*</span>
                                            </label>
                                            <input type="date" class="form-control" id="fechaInicio" required>
                                        </div>
                                        <div class="col-md-6 mb-3">
                                            <label for="fechaTerminacion" class="form-label">
                                                Fecha de Terminación <span class="text-danger">*</span>
                                            </label>
                                            <input type="date" class="form-control" id="fechaTerminacion" required>
                                        </div>
                                    </div>

                                    <!-- Datos de Expedición -->
                                    <h6 class="border-bottom pb-2 mb-3 mt-4">Datos de Expedición</h6>
                                    <div class="row">
                                        <div class="col-md-6 mb-3">
                                            <label for="idModalidadTitulacion" class="form-label">
                                                ID Modalidad de Titulación <span class="text-danger">*</span>
                                            </label>
                                            <input type="text" class="form-control" id="idModalidadTitulacion"
                                                   required placeholder="Ej: 1" value="1">
                                            <small class="text-muted">1 = POR TESIS</small>
                                        </div>
                                        <div class="col-md-6 mb-3">
                                            <label for="modalidadTitulacion" class="form-label">
                                                Modalidad de Titulación <span class="text-danger">*</span>
                                            </label>
                                            <input type="text" class="form-control" id="modalidadTitulacion"
                                                   required value="POR TESIS">
                                        </div>
                                        <div class="col-md-6 mb-3">
                                            <label for="fechaExpedicion" class="form-label">
                                                Fecha de Expedición <span class="text-danger">*</span>
                                            </label>
                                            <input type="date" class="form-control" id="fechaExpedicion" required>
                                        </div>
                                    </div>

                                    <div class="d-flex justify-content-end gap-2 mt-4">
                                        <button type="button" class="btn btn-secondary">
                                            <i class="bi bi-x-circle"></i> Cancelar
                                        </button>
                                        <button type="submit" class="btn btn-success" id="btnGenerarTitulo" disabled>
                                            <i class="bi bi-file-earmark-check"></i> Generar Título
                                        </button>
                                    </div>
                                </form>

                                <div id="alertaTitulo" class="alert d-none mt-3" role="alert"></div>
                            </div>
                        </div>
                    </div>

                    <!-- TAB: Consultar Títulos -->
                    <div class="tab-pane fade" id="consultarTitulos" role="tabpanel">
                        <div class="card">
                            <div class="card-header bg-soft-primary">
                                <h5 class="mb-0">
                                    <i class="bi bi-list-ul"></i> Títulos Generados
                                </h5>
                            </div>
                            <div class="card-body">
                                <div class="mb-3">
                                    <label for="buscarTitulo" class="form-label">
                                        Buscar Título
                                    </label>
                                    <div class="input-group">
                                        <input type="text" class="form-control" id="buscarTitulo"
                                               placeholder="Folio, matrícula o nombre del alumno">
                                        <button class="btn btn-primary" type="button" id="btnBuscarTitulo">
                                            <i class="bi bi-search"></i> Buscar
                                        </button>
                                    </div>
                                </div>

                                <div class="table-responsive">
                                    <table class="table table-hover">
                                        <thead class="table-light">
                                            <tr>
                                                <th>ID</th>
                                                <th>Folio de Control</th>
                                                <th>Alumno</th>
                                                <th>Programa</th>
                                                <th>Fecha Expedición</th>
                                                <th>Estatus</th>
                                                <th>Acciones</th>
                                            </tr>
                                        </thead>
                                        <tbody id="tablaTitulos">
                                            <tr>
                                                <td colspan="7" class="text-center text-muted">
                                                    No hay títulos generados. Use el tab "Generar Título" para crear uno nuevo.
                                                </td>
                                            </tr>
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- CONSTANCIAS - Secretaría Académica -->
            <section id="constanciasSection" class="admin-section d-none">
                <h3 class="section-title">Constancias por elaborar</h3>
                <p class="text-muted">
                    Aquí se muestran únicamente las solicitudes de constancias que ya fueron confirmadas por
                    Secretaría Administrativa y están listas para ser elaboradas y entregadas al alumno.
                </p>

                <!-- Filtros -->
                <div class="card mb-3">
                    <div class="card-body row g-3">
                        <div class="col-md-3">
                            <label class="form-label">Matrícula</label>
                            <input type="text" class="form-control" >
                        </div>
                        <div class="col-md-3">
                            <label class="form-label">Programa</label>
                            <select class="form-select">
                                <option value="">Todos</option>
                                <option>Lic. Cirujano Dentista</option>
                                <option>Especialidad en Ortodoncia</option>
                                <option>Especialidad en Endodoncia</option>
                            </select>
                        </div>
                        <div class="col-md-3">
                            <label class="form-label">Estado</label>
                            <select class="form-select">
                                <option value="">Todos</option>
                                <option>Pendiente de elaboración</option>
                                <option>En proceso</option>
                                <option>Lista para entrega</option>
                                <option>Entregada</option>
                            </select>
                        </div>
                        <div class="col-md-3 d-flex align-items-end">
                            <button class="btn btn-ide w-100" type="button">Buscar</button>
                        </div>
                    </div>
                </div>

                <!-- Tabla de solicitudes (solo confirmadas, no rechazadas) -->
                <div class="card mb-4">
                    <div class="card-header bg-soft-primary">
                        Solicitudes de constancias confirmadas
                    </div>
                    <div class="card-body p-0">
                        <div class="table-responsive">
                            <table class="table table-hover mb-0 align-middle">
                                <thead class="table-light">
                                    <tr>
                                        <th>Fecha solicitud</th>
                                        <th>Matrícula</th>
                                        <th>Alumno</th>
                                        <th>Programa</th>
                                        <th>Documentos solicitados</th>
                                        <th>Estado</th>
                                        <th>Acciones</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- DEMO: solo ejemplos de solicitudes que ya pasaron el filtro del secretario admin -->
                                    <tr>
                                        <td>01/01/2026</td>
                                        <td>IDEE2025001</td>
                                        <td>María López García</td>
                                        <td>Lic. Cirujano Dentista</td>
                                        <td>
                                            1 Kardex<br>
                                            1 Constancia con promedio
                                        </td>
                                        <td>
                                            <span class="badge bg-warning-subtle text-warning">Pendiente de
                                                elaboración</span>
                                        </td>
                                        <td>
                                            <button class="btn btn-sm btn-outline-primary mb-1" type="button"
                                                onclick="marcarEnProcesoDemo('IDE2025001')">
                                                Marcar en proceso
                                            </button>
                                            <button class="btn btn-sm btn-outline-success" type="button"
                                                onclick="marcarListaEntregaDemo('IDE2025001')">
                                                Marcar lista para entrega
                                            </button>
                                        </td>
                                    </tr>

                                    <tr>
                                        <td>09/12/2025</td>
                                        <td>IDE2024023</td>
                                        <td>Carlos Hernández Ruiz</td>
                                        <td>Lic. Cirujano Dentista</td>
                                        <td>
                                            2 Constancias de inscripción
                                        </td>
                                        <td>
                                            <span class="badge bg-success-subtle text-success">Lista para entrega</span>
                                        </td>
                                        <td>
                                            <button class="btn btn-sm btn-outline-secondary" type="button"
                                                onclick="marcarEntregadaDemo('IDE2024023')">
                                                Marcar como entregada
                                            </button>
                                        </td>
                                    </tr>

                                    <!-- Más filas dinámicas (solo confirmadas) -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </section>


        </div>
    </div>

    <!-- Modal: Nuevo/Editar Alumno -->
    <div class="modal fade" id="modalAlumno" tabindex="-1">
        <div class="modal-dialog modal-xl">
            <div class="modal-content">
                <div class="modal-header bg-primary text-white">
                    <h5 class="modal-title" id="modalAlumnoTitle">
                        <i class="bi bi-person-plus"></i> Nuevo Alumno
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="formAlumno">
                        <input type="hidden" id="alumnoId">

                        <h6 class="border-bottom pb-2 mb-3">Información Académica</h6>
                        <div class="row">
                            <div class="col-md-3 mb-3">
                                <label for="alumnoMatricula" class="form-label text-dark">
                                    Matrícula <span class="text-danger">*</span>
                                </label>
                                <input type="text" class="form-control" id="alumnoMatricula" required>
                            </div>

                            <div class="col-md-3 mb-3">
                                <label for="alumnoProgramaId" class="form-label text-dark">
                                    Programa Educativo <span class="text-danger">*</span>
                                </label>
                                <select class="form-select" id="alumnoProgramaId" required>
                                    <option value="">Seleccionar...</option>
                                </select>
                            </div>

                            <div class="col-md-2 mb-3">
                                <label for="alumnoCiclo" class="form-label text-dark">
                                    Ciclo Escolar
                                </label>
                                <input type="text" class="form-control" id="alumnoCiclo" placeholder="2024-2028">
                            </div>

                            <div class="col-md-2 mb-3">
                                <label for="alumnoTurno" class="form-label text-dark">
                                    Turno
                                </label>
                                <select class="form-select" id="alumnoTurno">
                                    <option value="">Seleccionar...</option>
                                    <option value="MATUTINO">Matutino</option>
                                    <option value="VESPERTINO">Vespertino</option>
                                    <option value="MIXTO">Mixto</option>
                                </select>
                            </div>

                            <div class="col-md-2 mb-3">
                                <label for="alumnoEstatus" class="form-label text-dark">
                                    Estatus <span class="text-danger">*</span>
                                </label>
                                <select class="form-select" id="alumnoEstatus" required>
                                    <option value="ACTIVA">Activa</option>
                                    <option value="INACTIVA">Inactiva</option>
                                    <option value="BAJA_TEMPORAL">Baja Temporal</option>
                                    <option value="BAJA_DEFINITIVA">Baja Definitiva</option>
                                    <option value="EGRESADO">Egresado</option>
                                </select>
                            </div>
                        </div>

                        <h6 class="border-bottom pb-2 mb-3 mt-3">Datos Personales</h6>
                        <div class="row">
                            <div class="col-md-4 mb-3">
                                <label for="alumnoNombre" class="form-label text-dark">
                                    Nombre(s) <span class="text-danger">*</span>
                                </label>
                                <input type="text" class="form-control" id="alumnoNombre" required>
                            </div>

                            <div class="col-md-4 mb-3">
                                <label for="alumnoApellidoPaterno" class="form-label text-dark">
                                    Apellido Paterno <span class="text-danger">*</span>
                                </label>
                                <input type="text" class="form-control" id="alumnoApellidoPaterno" required>
                            </div>

                            <div class="col-md-4 mb-3">
                                <label for="alumnoApellidoMaterno" class="form-label text-dark">
                                    Apellido Materno <span class="text-danger">*</span>
                                </label>
                                <input type="text" class="form-control" id="alumnoApellidoMaterno" required>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-4 mb-3">
                                <label for="alumnoCurp" class="form-label text-dark">
                                    CURP <span class="text-danger">*</span>
                                </label>
                                <input type="text" class="form-control" id="alumnoCurp" required
                                       maxlength="18" pattern="[A-Z]{4}[0-9]{6}[HM][A-Z]{5}[0-9A-Z]{2}">
                                <small class="text-muted">18 caracteres</small>
                            </div>

                            <div class="col-md-2 mb-3">
                                <label for="alumnoSexo" class="form-label text-dark">
                                    Sexo
                                </label>
                                <select class="form-select" id="alumnoSexo">
                                    <option value="">Seleccionar...</option>
                                    <option value="MASCULINO">Masculino</option>
                                    <option value="FEMENINO">Femenino</option>
                                </select>
                            </div>

                            <div class="col-md-3 mb-3">
                                <label for="alumnoFechaNacimiento" class="form-label text-dark">
                                    Fecha de Nacimiento
                                </label>
                                <input type="date" class="form-control" id="alumnoFechaNacimiento">
                            </div>

                            <div class="col-md-3 mb-3">
                                <label for="alumnoCodigoPostal" class="form-label text-dark">
                                    Código Postal
                                </label>
                                <input type="text" class="form-control" id="alumnoCodigoPostal" maxlength="5">
                            </div>
                        </div>

                        <h6 class="border-bottom pb-2 mb-3 mt-3">Datos de Contacto</h6>
                        <div class="row">
                            <div class="col-md-4 mb-3">
                                <label for="alumnoCorreoInstitucional" class="form-label text-dark">
                                    Correo Institucional
                                </label>
                                <input type="email" class="form-control" id="alumnoCorreoInstitucional"
                                       placeholder="alumno@idee.edu.mx">
                            </div>

                            <div class="col-md-4 mb-3">
                                <label for="alumnoCorreoPersonal" class="form-label text-dark">
                                    Correo Personal
                                </label>
                                <input type="email" class="form-control" id="alumnoCorreoPersonal">
                            </div>

                            <div class="col-md-4 mb-3">
                                <label for="alumnoTelefono" class="form-label text-dark">
                                    Teléfono
                                </label>
                                <input type="tel" class="form-control" id="alumnoTelefono" maxlength="10">
                            </div>
                        </div>

                        <h6 class="border-bottom pb-2 mb-3 mt-3">Contacto de Emergencia</h6>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="alumnoNombreContacto" class="form-label text-dark">
                                    Nombre Completo
                                </label>
                                <input type="text" class="form-control" id="alumnoNombreContacto">
                            </div>

                            <div class="col-md-6 mb-3">
                                <label for="alumnoTelefonoContacto" class="form-label text-dark">
                                    Teléfono
                                </label>
                                <input type="tel" class="form-control" id="alumnoTelefonoContacto" maxlength="10">
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-12 mb-3">
                                <label for="alumnoObservaciones" class="form-label text-dark">
                                    Observaciones
                                </label>
                                <textarea class="form-control" id="alumnoObservaciones" rows="2"></textarea>
                            </div>
                        </div>

                        <div id="alertaAlumno" class="alert d-none" role="alert"></div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                        <i class="bi bi-x-circle"></i> Cancelar
                    </button>
                    <button type="button" class="btn btn-primary" id="btnGuardarAlumno">
                        <i class="bi bi-save"></i> Guardar
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal: Nuevo/Editar Responsable -->
    <div class="modal fade" id="modalResponsable" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header bg-primary text-white">
                    <h5 class="modal-title" id="modalResponsableTitle">
                        <i class="bi bi-person-plus"></i> Nuevo Responsable de Firma
                    </h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <form id="formResponsable">
                        <input type="hidden" id="responsableId">

                        <div class="row">
                            <div class="col-md-4 mb-3">
                                <label for="responsableNombre" class="form-label text-dark">
                                    Nombre(s) <span class="text-danger">*</span>
                                </label>
                                <input type="text" class="form-control" id="responsableNombre" required>
                            </div>

                            <div class="col-md-4 mb-3">
                                <label for="responsablePrimerApellido" class="form-label text-dark">
                                    Primer Apellido <span class="text-danger">*</span>
                                </label>
                                <input type="text" class="form-control" id="responsablePrimerApellido" required>
                            </div>

                            <div class="col-md-4 mb-3">
                                <label for="responsableSegundoApellido" class="form-label text-dark">
                                    Segundo Apellido
                                </label>
                                <input type="text" class="form-control" id="responsableSegundoApellido">
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <label for="responsableCurp" class="form-label text-dark">
                                    CURP <span class="text-danger">*</span>
                                </label>
                                <input type="text" class="form-control" id="responsableCurp" required
                                       maxlength="18" pattern="[A-Z]{4}[0-9]{6}[HM][A-Z]{5}[0-9A-Z]{2}">
                                <small class="text-muted">18 caracteres</small>
                            </div>

                            <div class="col-md-3 mb-3">
                                <label for="responsableIdCargo" class="form-label text-dark">
                                    ID Cargo <span class="text-danger">*</span>
                                </label>
                                <input type="text" class="form-control" id="responsableIdCargo" required>
                            </div>

                            <div class="col-md-3 mb-3">
                                <label for="responsableOrdenFirma" class="form-label text-dark">
                                    Orden <span class="text-danger">*</span>
                                </label>
                                <input type="number" class="form-control" id="responsableOrdenFirma"
                                       required min="1" value="1">
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-md-8 mb-3">
                                <label for="responsableCargo" class="form-label text-dark">
                                    Cargo <span class="text-danger">*</span>
                                </label>
                                <input type="text" class="form-control" id="responsableCargo" required
                                       placeholder="Ej: Director General">
                            </div>

                            <div class="col-md-4 mb-3">
                                <label for="responsableAbrTitulo" class="form-label text-dark">
                                    Título Académico
                                </label>
                                <input type="text" class="form-control" id="responsableAbrTitulo"
                                       placeholder="Ej: Dr., Mtro., Lic.">
                            </div>
                        </div>

                        <div class="form-check mb-3">
                            <input class="form-check-input" type="checkbox" id="responsableActivo" checked>
                            <label class="form-check-label text-dark" for="responsableActivo">
                                Activo
                            </label>
                        </div>

                        <div id="alertaResponsable" class="alert d-none" role="alert"></div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                        <i class="bi bi-x-circle"></i> Cancelar
                    </button>
                    <button type="button" class="btn btn-primary" id="btnGuardarResponsable">
                        <i class="bi bi-save"></i> Guardar
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Navegación secciones admin
        const adminNavLinks = document.querySelectorAll("[data-admin-section]");
        adminNavLinks.forEach((link) => {
            link.addEventListener("click", function (e) {
                e.preventDefault();
                const sectionId = this.getAttribute("data-admin-section");
                activarAdminSection(sectionId);

                document.querySelectorAll("#adminNavbar .nav-link").forEach((nav) => {
                    nav.classList.remove("active");
                });
                if (this.classList.contains("dropdown-item")) {
                    const parentLink = this.closest(".dropdown").querySelector(".nav-link");
                    parentLink.classList.add("active");
                } else {
                    this.classList.add("active");
                }
            });
        });

        function activarAdminSection(sectionId) {
            document
                .querySelectorAll(".admin-section")
                .forEach((sec) => sec.classList.add("d-none"));
            const section = document.getElementById(sectionId);
            if (section) {
                section.classList.remove("d-none");
            }
        }

        function confirmDelete(tipo, nombre) {
            const seguro = confirm(`¿Seguro que quieres eliminar el/la ${tipo}: "${nombre}"?`);
            if (seguro) {
                alert(`${tipo} eliminado (demo, sin persistencia).`);
            }
        }

        function demoEdit(tipo) {
            alert(`Aquí se abriría el formulario para editar el/la ${tipo}. (Demo visual)`);
        }

        function buscarAlumnos() {
            alert("Consulta de alumnos ejecutada.\n(Demo: se enviarán los filtros al backend).");
        }

        function limpiarFiltros() {
            document
                .querySelectorAll("#alumnoSearchForm .alumno-filter")
                .forEach((input) => {
                    if (input.tagName === "SELECT") {
                        input.selectedIndex = 0;
                    } else {
                        input.value = "";
                    }
                });
        }

        function descargarExcelAlumnos() {
            alert("Descarga de Excel de alumnos inscritos.\n(Demo: se generaría un archivo .xlsx).");
        }

        function seleccionarPrograma(nombre) {
            document.getElementById("programaSeleccionadoLabel").textContent = nombre;
        }

        function guardarAlumnoDemo() {
            alert(
                "Alumno guardado (demo).\nSe enviaría un correo automático al correo personal para continuar el proceso de inscripción."
            );
        }
        function mostrarCampoOtroEtiqueta() {
            const select = document.getElementById("etiquetaSelect");
            const campoOtro = document.getElementById("campoEtiquetaOtro");

            if (select.value === "otro") {
                campoOtro.classList.remove("d-none");
            } else {
                campoOtro.classList.add("d-none");
            }
        }
        function marcarEnProcesoDemo(matricula) {
            alert(
                "La solicitud de constancias del alumno " + matricula +
                " se marcó como 'En proceso' (demo). En un sistema real se actualizaría en la base de datos."
            );
        }

        function marcarListaEntregaDemo(matricula) {
            alert(
                "La solicitud de constancias del alumno " + matricula +
                " se marcó como 'Lista para entrega' (demo)."
            );
        }

        function marcarEntregadaDemo(matricula) {
            alert(
                "La solicitud de constancias del alumno " + matricula +
                " se marcó como 'Entregada' (demo)."
            );
        }

    </script>

    <!-- Scripts de conexión al backend -->
    <script src="../js/config.js"></script>
    <script src="../js/roles.js"></script>
    <script src="../js/auth.js"></script>
    <script src="../js/sistema-roles-unified.js"></script>
    <script src="../js/app.js"></script>
    <script src="../js/gestion-programas.js"></script>
    <script src="../js/gestion-asignaturas.js"></script>
    <script src="../js/gestion-docentes.js"></script>
    <script src="../js/gestion-alumnos.js"></script>
    <script src="../js/gestion-permisos.js"></script>
    <script>
        // Variables globales
        let currentUser = null;
        let personalData = null;

        // Inicializar página
        // ==================== PROGRAMAS EDUCATIVOS ====================

        /**
         * Cargar y mostrar programas educativos
         */
        async function cargarProgramasEducativos() {
            try {
                // Usar authFetch para peticiones autenticadas
                const programas = await authFetch('/programas-educativos');
                renderizarTablaProgramas(programas);
            } catch (error) {
                console.error('Error al cargar programas:', error);
                mostrarErrorTablaProgramas('Error al cargar los programas educativos');
            }
        }

        /**
         * Cargar calificaciones desde backend y renderizar
         */
        async function cargarCalificaciones() {
            try {
                const calificaciones = await authFetch('/calificaciones');
                const tbody = document.querySelector('#calificacionesSection table tbody');
                if (!tbody) return;
                if (!Array.isArray(calificaciones) || calificaciones.length === 0) {
                    tbody.innerHTML = createEmptyTableMessage('No hay calificaciones disponibles');
                    return;
                }

                tbody.innerHTML = '';
                calificaciones.forEach(c => {
                    const tr = document.createElement('tr');
                    tr.innerHTML = `
                        <td>${c.alumno ? c.alumno.matricula : ''}</td>
                        <td>${c.alumno ? c.alumno.nombreCompleto || (c.alumno.nombre + ' ' + (c.alumno.apellidoPaterno||'') ) : ''}</td>
                        <td>${c.alumno ? c.alumno.curp || '' : ''}</td>
                        <td>${c.asignatura ? c.asignatura.nombre : ''}</td>
                        <td>${c.grupo ? (c.grupo.nombre || '') : ''}</td>
                        <td>${c.calificacionFinal != null ? c.calificacionFinal : ''}</td>
                        <td>${c.asistenciaPorcentaje != null ? c.asistenciaPorcentaje + '%' : ''}</td>
                        <td><input data-id="${c.id}" class="form-control form-control-sm calif-input" type="number" min="0" max="100" value="${c.calificacionFinal != null ? c.calificacionFinal : ''}" /></td>
                        <td><span class="badge ${c.confirmada ? 'bg-success-subtle text-success' : 'bg-warning-subtle text-warning'}">${c.estadoAprobacion || (c.confirmada ? 'Confirmada' : 'Pendiente')}</span></td>
                        <td><button data-id="${c.id}" class="btn btn-sm btn-ide btn-confirmar">Confirmar</button></td>
                    `;
                    tbody.appendChild(tr);
                });

                // Delegación: manejar clicks en botones confirmar y cambios en inputs
                tbody.querySelectorAll('.btn-confirmar').forEach(btn => {
                    btn.addEventListener('click', async (e) => {
                        const id = btn.getAttribute('data-id');
                        try {
                            await authFetch(`/calificaciones/${id}/confirmar`, { method: 'POST' });
                            await cargarCalificaciones();
                            showSuccess('Calificación confirmada');
                        } catch (err) {
                            handleNetworkError(err);
                        }
                    });
                });

                tbody.querySelectorAll('.calif-input').forEach(input => {
                    input.addEventListener('change', async (e) => {
                        const id = input.getAttribute('data-id');
                        const value = parseFloat(input.value);
                        if (isNaN(value)) return;
                        try {
                            await authFetch(`/calificaciones/${id}`, {
                                method: 'PUT',
                                body: JSON.stringify({ calificacionFinal: value })
                            });
                            showSuccess('Calificación actualizada');
                        } catch (err) {
                            handleNetworkError(err);
                        }
                    });
                });

            } catch (error) {
                console.error('Error al cargar calificaciones:', error);
            }
        }

        /**
         * Renderizar la tabla de programas
         */
        function renderizarTablaProgramas(programas) {
            const tbody = document.getElementById('programasTableBody');
            if (!tbody) return;

            if (programas.length === 0) {
                tbody.innerHTML = `
                    <tr>
                        <td colspan="6" class="text-center text-muted py-4">
                            <i class="bi bi-inbox"></i> No hay programas registrados
                        </td>
                    </tr>
                `;
                return;
            }

            tbody.innerHTML = programas.map(programa => `
                <tr class="cursor-pointer">
                    <td><strong>${programa.clave || 'N/A'}</strong></td>
                    <td>${programa.nombre || 'N/A'}</td>
                    <td>${programa.tipoPrograma || 'N/A'}</td>
                    <td>${programa.duracionPeriodos || 'N/A'} ${programa.tipoPeriodo ? programa.tipoPeriodo.toLowerCase() + 's' : ''}</td>
                    <td><small>${programa.rvoe || 'N/A'}</small></td>
                    <td>${getBadgeEstatusProgramas(programa.estatus)}</td>
                    <td>
                        <button class="btn btn-sm btn-outline-secondary me-1" onclick="editarPrograma(${programa.id}); event.stopPropagation();">
                            Editar
                        </button>
                        <button class="btn btn-sm btn-outline-danger" onclick="confirmarEliminarPrograma(${programa.id}, '${programa.nombre}'); event.stopPropagation();">
                            Eliminar
                        </button>
                    </td>
                </tr>
            `).join('');
        }

        /**
         * Obtener badge de estatus para programas
         */
        function getBadgeEstatusProgramas(estatus) {
            if (estatus === 'ACTIVO') {
                return '<span class="badge bg-success-subtle text-success">Activo</span>';
            } else {
                return '<span class="badge bg-secondary">Inactivo</span>';
            }
        }

        /**
         * Mostrar error en la tabla de programas
         */
        function mostrarErrorTablaProgramas(mensaje) {
            const tbody = document.getElementById('programasTableBody');
            if (!tbody) return;

            tbody.innerHTML = `
                <tr>
                    <td colspan="6" class="text-center text-danger py-4">
                        <i class="bi bi-exclamation-triangle"></i> ${mensaje}
                    </td>
                </tr>
            `;
        }

        /**
         * Editar programa (placeholder)
         */
        function editarPrograma(id) {
            alert('Funcionalidad de edición en desarrollo. ID del programa: ' + id);
        }

        /**
         * Confirmar eliminar programa (placeholder)
         */
        function confirmarEliminarPrograma(id, nombre) {
            if (confirm(`¿Está seguro de eliminar el programa "${nombre}"?\n\nEsta acción no se puede deshacer.`)) {
                alert('Funcionalidad de eliminación en desarrollo. ID del programa: ' + id);
            }
        }

        async function initSecretariaAcademicaPage() {
            try {
                // Verificar autenticación y cargar datos del usuario
                currentUser = await initializePage('SECRETARIA_ACADEMICA');

                if (!currentUser) {
                    return;
                }

                // Aplicar permisos según rol
                inicializarSistemaPermisos();

                // Cargar datos del personal
                await loadPersonalData();

                // Cargar programas educativos
                await cargarProgramasEducativos();

                // Cargar alumnos
                await cargarAlumnos();

                // Cargar calificaciones para revisión/confirmación
                await cargarCalificaciones();

                console.log('Página de secretaría académica inicializada correctamente');
            } catch (error) {
                handleNetworkError(error);
            }
        }

        // Cargar datos del personal desde el backend
        async function loadPersonalData() {
            try {
                const response = await authFetch('/auth/me');

                if (response.personal) {
                    personalData = response.personal;
                    updatePersonalUI();
                } else {
                    console.warn('No se encontraron datos de personal asociados a este usuario');
                }
            } catch (error) {
                console.error('Error al cargar datos del personal:', error);
            }
        }

        // Actualizar UI con datos del personal
        function updatePersonalUI() {
            if (!personalData) return;

            const emailSpan = document.querySelector('.navbar .text-light');
            if (emailSpan && personalData.correoInstitucional) {
                emailSpan.textContent = personalData.correoInstitucional;
            }

            console.log('Datos del personal cargados:', personalData);
        }

        // Inicializar cuando el DOM esté listo
        document.addEventListener('DOMContentLoaded', initSecretariaAcademicaPage);
    </script>
</body>

</html>