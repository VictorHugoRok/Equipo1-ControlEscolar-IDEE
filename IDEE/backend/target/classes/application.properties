# ===============================
# = APPLICATION
# ===============================
spring.application.name=IDEE Control Escolar
server.port=8080
server.shutdown=graceful
spring.lifecycle.timeout-per-shutdown-phase=30s

# ===============================
# = DATABASE - PostgreSQL
# ===============================
spring.datasource.url=jdbc:postgresql://localhost:5432/idee_control_escolar
spring.datasource.username=postgres
spring.datasource.password=admin1234
spring.datasource.driver-class-name=org.postgresql.Driver

# ===============================
# = JPA / HIBERNATE
# ===============================
# update: Hibernate maneja las tablas automáticamente
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=true
spring.jpa.properties.hibernate.dialect=org.hibernate.dialect.PostgreSQLDialect
spring.jpa.properties.hibernate.format_sql=true
spring.jpa.properties.hibernate.jdbc.lob.non_contextual_creation=true

# ===============================
# = FLYWAY (Migraciones de BD)
# ===============================
# Desactivado temporalmente - usar solo Hibernate
spring.flyway.enabled=false

# ===============================
# = JWT Configuration
# ===============================
jwt.secret=9e25e2qe8r9e2q8r9e2q8r9e2q8r9e2q8r9e2q8r9e2q8r9e2q8r9e2q8r9e2q8r
jwt.expiration=86400000

# ===============================
# = CORS Configuration
# ===============================
cors.allowed-origins=http://localhost:3000,http://127.0.0.1:5500,http://localhost:5500
cors.allowed-methods=GET,POST,PUT,DELETE,PATCH,OPTIONS
cors.allowed-headers=*
cors.allow-credentials=true

# ===============================
# = FILE UPLOAD
# ===============================
spring.servlet.multipart.max-file-size=10MB
spring.servlet.multipart.max-request-size=10MB
file.upload-dir=./uploads

# ===============================
# = LOGGING
# ===============================
logging.level.com.idee.controlescolar=DEBUG
logging.level.org.springframework.security=DEBUG
logging.level.org.hibernate.SQL=DEBUG
logging.level.org.hibernate.type.descriptor.sql.BasicBinder=TRACE
logging.level.com.idee.controlescolar.service.TituloElectronicoFirmadoService=DEBUG

# Logging para debugging de inicialización
logging.level.root=INFO
logging.level.org.springframework.boot=INFO
logging.level.org.springframework.data.jpa=DEBUG
logging.level.org.springframework.data.repository=DEBUG
logging.level.org.hibernate.connection.C3P0ConnectionProvider=DEBUG
logging.level.org.postgresql=DEBUG

# Loggear errores críticos de inicialización
logging.level.org.springframework.context=INFO
logging.level.org.springframework.beans.factory=INFO
logging.level.org.springframework.orm.jpa=DEBUG

# Archivo de log para debugging
logging.file.name=./logs/spring-boot.log
logging.file.max-size=10MB
logging.file.max-history=30
logging.pattern.console=%d{yyyy-MM-dd HH:mm:ss} - %logger{36} - %msg%n
logging.pattern.file=%d{yyyy-MM-dd HH:mm:ss} [%thread] %-5level %logger{36} - %msg%n

# ===============================
# = ACTUATOR (opcional)
# ===============================
management.endpoints.web.exposure.include=health,info

# ===============================
# = TOMCAT CONFIGURATION
# ===============================
# Configuración para mantener el servidor activo
server.tomcat.threads.max=200
server.tomcat.threads.min-spare=10
server.tomcat.accept-count=100
server.tomcat.connection-timeout=20000
server.connection-timeout=20000

# ===============================
# = SPRING BOOT CONFIGURATION
# ===============================
# La aplicación se mantendrá ejecutando en modo daemon
# Presione Ctrl+C para detenerla
management.endpoint.health.show-details=always
